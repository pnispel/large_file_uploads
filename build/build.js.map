{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","lib/promise.js","src/file_uploader.js","src/index.js","src/util.js"],"names":[],"mappings":"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","file":"build.js","sourceRoot":"/source/","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","// (c) copyright unscriptable.com / John Hann\n// License MIT\n// For more robust promises, see https://github.com/briancavalier/when.js.\n\nfunction Promise () {\n  this._thens = [];\n}\n\nPromise.all = function (promises) {\n  var p = new Promise();\n  var size = promises.length;\n  var returned = 0;\n  var returns = [];\n\n  promises.forEach(function (promise) {\n    promise.then((function (promise) {\n      return function () {\n        returned++;\n\n        returns.push(arguments);\n\n        if (returned === size) {\n          p.resolve(returns);\n        }\n      }\n    })(promise));\n  });\n\n  setTimeout((function (size) {\n    return function () {\n      if (size === 0) {\n        p.resolve();\n      }\n    }\n  })(size));\n\n  return p;\n};\n\nPromise.prototype = {\n\n  /* This is the \"front end\" API. */\n\n  // then(onResolve, onReject): Code waiting for this promise uses the\n  // then() method to be notified when the promise is complete. There\n  // are two completion callbacks: onReject and onResolve. A more\n  // robust promise implementation will also have an onProgress handler.\n  then: function (onResolve, onReject) {\n    // capture calls to then()\n    this._thens.push({ resolve: onResolve, reject: onReject });\n  },\n\n  // Some promise implementations also have a cancel() front end API that\n  // calls all of the onReject() callbacks (aka a \"cancelable promise\").\n  // cancel: function (reason) {},\n\n  /* This is the \"back end\" API. */\n\n  // resolve(resolvedValue): The resolve() method is called when a promise\n  // is resolved (duh). The resolved value (if any) is passed by the resolver\n  // to this method. All waiting onResolve callbacks are called\n  // and any future ones are, too, each being passed the resolved value.\n  resolve: function (val) { this._complete('resolve', val); },\n\n  // reject(exception): The reject() method is called when a promise cannot\n  // be resolved. Typically, you'd pass an exception as the single parameter,\n  // but any other argument, including none at all, is acceptable.\n  // All waiting and all future onReject callbacks are called when reject()\n  // is called and are passed the exception parameter.\n  reject: function (ex) { this._complete('reject', ex); },\n\n  // Some promises may have a progress handler. The back end API to signal a\n  // progress \"event\" has a single parameter. The contents of this parameter\n  // could be just about anything and is specific to your implementation.\n  // progress: function (data) {},\n\n  /* \"Private\" methods. */\n\n  _complete: function (which, arg) {\n    // switch over to sync then()\n    this.then = which === 'resolve' ?\n      function (resolve, reject) { resolve && resolve(arg); } :\n      function (resolve, reject) { reject && reject(arg); };\n    // disallow multiple calls to resolve or reject\n    this.resolve = this.reject =\n      function () { throw new Error('Promise already completed.'); };\n    // complete all waiting (async) then()s\n    var aThen, i = 0;\n    while (aThen = this._thens[i++]) { aThen[which] && aThen[which](arg); }\n    delete this._thens;\n  }\n\n};\n\nexport default Promise;\n","import Promise from \"../lib/promise\";\nimport Util from \"./util\";\n\n// source: http://creativejs.com/tutorials/advanced-uploading-techniques-part-1/\n\n/* -------------------------------------------------------------------------- */\n\nclass FileUploader {\n  constructor(file, options) {\n    this.file = file;\n\n    this.options = Util.extend({\n      url: \"/upload\",\n      chunk_size: (100 * 1024) // 100 KB\n    }, options);\n\n    this.file_size = file.size;\n\n    this.range_start = 0;\n    this.range_end = this.options.chunk_size;\n\n    if (\"mozSlice\" in this.file) {\n        this.slice_method = \"mozSlice\";\n    }\n    else if (\"webkitSlice\" in this.file) {\n        this.slice_method = \"webkitSlice\";\n    }\n    else {\n        this.slice_method = \"slice\";\n    }\n\n    this.upload_request = new XMLHttpRequest();\n    this.upload_request.onload = this.__onChunkComplete.bind(this);\n\n    this.is_paused = false;\n    this.__upload();\n  }\n\n  __onUploadComplete () {\n    console.log('upload complete');\n  }\n\n  __upload () {\n    let chunk;\n\n    if (this.range_end > this.file_size) {\n      this.range_end = this.file_size;\n    }\n\n    chunk = this.file[this.slice_method](this.range_start, this.range_end);\n\n    this.upload_request.open(\"POST\", this.options.url, true);\n    this.upload_request.overrideMimeType(\"application/octet-stream\");\n\n    if (this.range_start !== 0) {\n      this.upload_request.setRequestHeader(\"Content-Range\", \"bytes \" + this.range_start + \"-\" + this.range_end + \"/\" + this.file_size);\n    }\n\n    this.upload_request.send(chunk);\n  }\n\n  __onChunkComplete () {\n    if (this.range_end >= this.file_size) {\n      this.__onUploadComplete();\n      return;\n    }\n\n    this.range_start = this.range_end;\n    this.range_end = this.range_start + this.options.chunk_size;\n\n    if (!this.is_paused) {\n      this.__upload();\n    }\n  }\n}\n\n/* -------------------------------------------------------------------------- */\n\nexport default FileUploader\n","import Promise from \"../lib/promise\";\nimport FileUploader from \"./file_uploader\";\nimport Util from \"./util\";\n\n/* -------------------------------------------------------------------------- */\n\nconst Uploader = {\n  __inputs: {},\n  __uploads: [],\n\n  watch: function (fileInput, key) {\n    let self = this;\n\n    let handleFiles = (function (key) {\n      return function () {\n        let fileList = this.files;\n\n        if (fileList.length) {\n          self.__inputs[key] = fileList;\n        }\n      };\n    })(key);\n\n    this.__inputs[key] = [];\n\n    fileInput.addEventListener(\"change\", handleFiles, false);\n  },\n\n  remove: function (key) {\n\n  },\n\n  startUpload: function (key) {\n    let files = this.__inputs[key];\n\n    for (var i = 0; i < files.length; i++) {\n      let file = files[i];\n\n      this.__uploads.push(new FileUploader(file));\n    }\n  }\n};\n\n/* -------------------------------------------------------------------------- */\n\nexport default Uploader;\n","const Util = {\n  extend (dest, source) {\n    for (var k in source) {\n        if (source.hasOwnProperty(k)) {\n            var value = source[k];\n            if (dest.hasOwnProperty(k) && typeof dest[k] === \"object\" &&\n                typeof value === \"object\") {\n\n                extend(dest[k], value);\n            } else {\n                dest[k] = value;\n            }\n        }\n    }\n\n    return dest;\n  }\n}\n\nexport default Util\n"]}